const path=require("path"),fileService=require("../services/fileServices"),timestamp=Date.now(),date=new Date(timestamp),day=date.getDate(),month=date.getMonth()+1,year=date.getFullYear();let fileCounter=0;module.exports={uploadFile:async(e,r)=>{try{if(!e.files||0===e.files.length)return r.status(400).json({error:"Nenhum arquivo enviado."});const t=e.files[0],o=t.originalname,a=path.extname(o);fileCounter+=1;const s=`Reuniao-${day}-${month}-${year}-${fileCounter}${a}`;t.filename=s,fileService.uploadFile(t,((e,t)=>e?r.status(500).json({error:"Erro ao fazer o upload do arquivo.",details:e.message}):r.status(200).json({message:"Arquivo enviado com sucesso.",url:t})))}catch(e){return console.error("Erro no controller:",e),r.status(500).json({error:"Erro inesperado.",details:e.message})}}};